<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¯æ—¥çš„èŠ±è²»è¿½è¹¤å™¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap');

        body {
            font-family: 'Noto Sans TC', sans-serif;
        }

        .progress-bar {
            transition: all 0.5s ease;
        }

        .character-animation {
            transition: all 0.8s ease;
        }

        .bounce-in {
            animation: bounceIn 0.6s ease;
        }

        @keyframes bounceIn {
            0% {
                transform: scale(0.3);
                opacity: 0;
            }

            50% {
                transform: scale(1.05);
            }

            70% {
                transform: scale(0.9);
            }

            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .shake {
            animation: shake 0.5s ease-in-out;
        }

        @keyframes shake {

            0%,
            100% {
                transform: translateX(0);
            }

            25% {
                transform: translateX(-5px);
            }

            75% {
                transform: translateX(5px);
            }
        }

        .pulse-red {
            animation: pulseRed 1s infinite;
        }

        @keyframes pulseRed {

            0%,
            100% {
                background-color: rgb(239 68 68);
            }

            50% {
                background-color: rgb(220 38 38);
            }
        }
    </style>
</head>

<body class="bg-gradient-to-br from-yellow-50 via-amber-50 to-orange-50 min-h-screen p-4">
    <div class="max-w-6xl mx-auto">
        <!-- æ¨™é¡Œ -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-purple-800 mb-2">ğŸ’° æ¯æ—¥çš„èŠ±è²»è¿½è¹¤å™¨ ğŸ’°</h1>
            <p class="text-purple-600">è®“å¯æ„›çš„å­¸ç”Ÿé™ªä½ ç®¡ç†æ¯æ—¥èŠ±è²»ï¼</p>
        </div>



        <!-- ç¬¬ä¸€åˆ—ï¼šæ©«å‘æ’åˆ— - å·¦å´å€‹äººè¨­å®šã€ä¸­é–“è§’è‰²ã€å³å´èŠ±è²»çµ±è¨ˆ -->
        <div class="bg-pink-50 rounded-3xl shadow-lg p-6 mb-8">
            <div class="grid grid-cols-3 gap-4 items-stretch min-h-[400px]">
                <!-- å·¦å´ï¼šå€‹äººè¨­å®šã€ç”¨æˆ¶è³‡è¨Šã€é ç®—ç‹€æ…‹åŠèŠ±è²»å°æç¤º -->
                <div class="h-full flex flex-col space-y-3">
                    <!-- å€‹äººè³‡è¨Šèˆ‡ç”¨æˆ¶é¡¯ç¤ºåˆä½µ -->
                    <div class="bg-yellow-50 rounded-xl p-4 flex flex-col">
                        <div class="text-sm font-medium text-yellow-800 mb-3 text-center">å€‹äººè³‡è¨Š</div>

                        <!-- è¼¸å…¥è¡¨å–® -->
                        <div class="space-y-2 flex-shrink-0 mb-3">
                            <input type="text" id="userNameInput" placeholder="è«‹è¼¸å…¥å§“å"
                                class="w-full px-3 py-2 border border-yellow-200 rounded-lg focus:border-yellow-400 focus:outline-none text-sm">
                            <input type="number" id="dailyBudgetInput" placeholder="è«‹è¨­å®šæ¯æ—¥é ç®—"
                                class="w-full px-3 py-2 border border-yellow-200 rounded-lg focus:border-yellow-400 focus:outline-none text-sm">
                            <button onclick="setUserInfo()"
                                class="w-full bg-purple-500 hover:bg-purple-600 text-white px-3 py-2 rounded-lg font-medium text-sm transition-all">
                                è¨­å®š
                            </button>
                        </div>

                        <!-- ç”¨æˆ¶è³‡è¨Šé¡¯ç¤º -->
                        <div id="userDisplay"
                            class="opacity-0 transition-opacity duration-500 flex-1 flex flex-col justify-center">
                            <div class="bg-purple-100 rounded-xl p-3">
                                <div class="text-center">
                                    <div class="text-purple-800 font-medium mb-2">
                                        <div class="text-sm">ğŸ‘‹ <span id="displayName">ä½¿ç”¨è€…</span></div>
                                    </div>
                                    <div class="text-purple-700">
                                        <div class="text-xs mb-1">ä»Šæ—¥é ç®—</div>
                                        <div class="text-sm font-bold">ğŸ’° <span id="displayBudget">0</span> å…ƒ</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- é ç®—ç‹€æ…‹ -->
                    <div class="bg-blue-50 rounded-xl p-3 flex-1">
                        <div class="text-sm font-medium text-blue-800 mb-2 text-center">é ç®—ç‹€æ…‹</div>
                        <div class="space-y-1 text-sm">
                            <div class="flex items-center justify-between">
                                <span class="text-blue-600">é ç®—ä¸Šé™</span>
                                <span class="text-blue-600 font-medium"><span id="budgetLimit">0</span> å…ƒ</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-red-600">å·²èŠ±è²»</span>
                                <span class="text-red-600 font-medium"><span id="spentAmount">0</span> å…ƒ</span>
                            </div>
                            <div class="flex items-center justify-between">
                                <span class="text-green-600">å‰©é¤˜é ç®—</span>
                                <span class="text-green-600 font-medium"><span id="remainingAmount">0</span> å…ƒ</span>
                            </div>
                        </div>
                    </div>

                    <!-- èŠ±è²»æç¤º -->
                    <div class="bg-red-50 rounded-xl p-3 flex-shrink-0">
                        <div class="text-xs font-medium text-red-800 mb-2 text-center">èŠ±è²»æç¤º</div>
                        <div class="text-center">
                            <div class="text-xs text-purple-600">
                                24å°æ™‚å†·éœæœŸæé†’<br>
                                é¿å…è¡å‹•æ¶ˆè²»
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ä¸­é–“ï¼šè§’è‰²äººç‰©ä¸Šæ–¹é¡¯ç¤ºå§“åã€æ¯æ—¥é ç®—é‡‘é¡åŠç¾å¥½çš„ä¸€å¤©å°±å¾æ—©é¤é–‹å§‹ -->
                <div class="character-animation text-center">
                    <!-- è§’è‰²ä¸Šæ–¹è³‡è¨Š -->
                    <div class="mb-4 space-y-2">
                        <div class="bg-gradient-to-r from-pink-100 to-purple-100 rounded-xl p-3">
                            <div class="text-purple-800 font-bold text-sm">
                                <span id="characterName">è«‹å…ˆè¨­å®šå€‹äººè³‡è¨Š</span>
                            </div>
                            <div class="text-purple-600 text-xs">
                                æ¯æ—¥é ç®—ï¼š<span id="characterBudget" class="font-medium">0</span> å…ƒ
                            </div>
                        </div>
                        <div class="bg-yellow-100 rounded-xl p-2">
                            <div class="text-orange-600 text-xs font-medium">
                                â˜€ï¸ ç¾å¥½çš„ä¸€å¤©å°±å¾æ—©é¤é–‹å§‹ï¼
                            </div>
                        </div>
                    </div>

                    <div class="relative inline-block">
                        <!-- æ¥“ä¹‹è°·éŠæˆ²é¢¨æ ¼å­¸ç”Ÿ -->
                        <svg width="200" height="280" viewBox="0 0 200 280" id="characterSvg">
                            <!-- èº«é«” (Qç‰ˆæ¯”ä¾‹) -->
                            <rect x="82" y="160" width="36" height="50" rx="18" fill="#FDBCB4" id="body" />

                            <!-- å­¸ç”Ÿåˆ¶æœä¸Šè¡£ (æ¥“ä¹‹è°·é¢¨æ ¼) -->
                            <rect x="84" y="160" width="32" height="45" rx="16" fill="#ffffff" id="uniform" />
                            <!-- åˆ¶æœé‚Šæ¡† -->
                            <rect x="84" y="160" width="32" height="45" rx="16" fill="none" stroke="#000000"
                                stroke-width="2" id="uniformBorder" />
                            <!-- è¥¯è¡«é ˜å­ -->
                            <polygon points="92,160 100,170 108,160 108,155 92,155" fill="#f0f0f0" stroke="#000000"
                                stroke-width="1.5" id="collar" />
                            <!-- å­¸æ ¡é ˜å¸¶ -->
                            <rect x="97" y="170" width="6" height="18" fill="#dc2626" stroke="#000000" stroke-width="1"
                                id="tie" />
                            <polygon points="97,188 103,188 100,194" fill="#b91c1c" stroke="#000000" stroke-width="1"
                                id="tieEnd" />
                            <!-- è¥¯è¡«é‡¦å­ -->
                            <circle cx="100" cy="175" r="2" fill="#e5e5e5" stroke="#000000" stroke-width="1"
                                id="button1" />
                            <circle cx="100" cy="185" r="2" fill="#e5e5e5" stroke="#000000" stroke-width="1"
                                id="button2" />
                            <circle cx="100" cy="195" r="2" fill="#e5e5e5" stroke="#000000" stroke-width="1"
                                id="button3" />

                            <!-- å·¦æ‰‹è‡‚ (Qç‰ˆ) -->
                            <rect x="62" y="165" width="20" height="30" rx="10" fill="#FDBCB4" id="leftArm" />
                            <rect x="62" y="165" width="20" height="30" rx="10" fill="none" stroke="#000000"
                                stroke-width="2" id="leftArmBorder" />
                            <rect x="64" y="165" width="16" height="25" rx="8" fill="#ffffff" id="leftSleeve" />
                            <!-- å·¦æ‰‹ -->
                            <circle cx="72" cy="200" r="8" fill="#FDBCB4" stroke="#000000" stroke-width="2"
                                id="leftHand" />

                            <!-- å³æ‰‹è‡‚ (Qç‰ˆ) -->
                            <rect x="118" y="165" width="20" height="30" rx="10" fill="#FDBCB4" id="rightArm" />
                            <rect x="118" y="165" width="20" height="30" rx="10" fill="none" stroke="#000000"
                                stroke-width="2" id="rightArmBorder" />
                            <rect x="120" y="165" width="16" height="25" rx="8" fill="#ffffff" id="rightSleeve" />
                            <!-- å³æ‰‹ -->
                            <circle cx="128" cy="200" r="8" fill="#FDBCB4" stroke="#000000" stroke-width="2"
                                id="rightHand" />

                            <!-- å­¸ç”Ÿè£™å­ (æ¥“ä¹‹è°·é¢¨æ ¼) -->
                            <rect x="78" y="210" width="44" height="25" rx="5" fill="#1f2937" id="pants" />
                            <rect x="78" y="210" width="44" height="25" rx="5" fill="none" stroke="#000000"
                                stroke-width="2" id="pantsBorder" />
                            <!-- è£™å­è¤¶çšºç·š -->
                            <line x1="88" y1="215" x2="88" y2="230" stroke="#374151" stroke-width="1.5" />
                            <line x1="100" y1="215" x2="100" y2="230" stroke="#374151" stroke-width="1.5" />
                            <line x1="112" y1="215" x2="112" y2="230" stroke="#374151" stroke-width="1.5" />

                            <!-- å·¦è…¿ (Qç‰ˆ) -->
                            <rect x="85" y="235" width="12" height="30" rx="6" fill="#FDBCB4" id="leftLeg" />
                            <rect x="85" y="235" width="12" height="30" rx="6" fill="none" stroke="#000000"
                                stroke-width="2" id="leftLegBorder" />
                            <!-- å·¦è¥ªå­ -->
                            <rect x="86" y="255" width="10" height="15" rx="5" fill="#ffffff" id="leftSock" />
                            <rect x="86" y="255" width="10" height="15" rx="5" fill="none" stroke="#000000"
                                stroke-width="1.5" id="leftSockBorder" />
                            <!-- å·¦é‹ (æ¥“ä¹‹è°·å­¸ç”Ÿé‹) -->
                            <ellipse cx="91" cy="275" rx="10" ry="5" fill="#2c3e50" stroke="#000000" stroke-width="2"
                                id="leftShoe" />
                            <ellipse cx="91" cy="273" rx="8" ry="3" fill="#374151" id="leftShoeTop" />

                            <!-- å³è…¿ (Qç‰ˆ) -->
                            <rect x="103" y="235" width="12" height="30" rx="6" fill="#FDBCB4" id="rightLeg" />
                            <rect x="103" y="235" width="12" height="30" rx="6" fill="none" stroke="#000000"
                                stroke-width="2" id="rightLegBorder" />
                            <!-- å³è¥ªå­ -->
                            <rect x="104" y="255" width="10" height="15" rx="5" fill="#ffffff" id="rightSock" />
                            <rect x="104" y="255" width="10" height="15" rx="5" fill="none" stroke="#000000"
                                stroke-width="1.5" id="rightSockBorder" />
                            <!-- å³é‹ (æ¥“ä¹‹è°·å­¸ç”Ÿé‹) -->
                            <ellipse cx="109" cy="275" rx="10" ry="5" fill="#2c3e50" stroke="#000000" stroke-width="2"
                                id="rightShoe" />
                            <ellipse cx="109" cy="273" rx="8" ry="3" fill="#374151" id="rightShoeTop" />

                            <!-- é ­éƒ¨ (æ¥“ä¹‹è°·ç‰¹è‰²å¤§é ­) -->
                            <circle cx="100" cy="120" r="35" fill="#FDBCB4" stroke="#000000" stroke-width="3"
                                id="head" />

                            <!-- æ¥“ä¹‹è°·é¢¨æ ¼é«®å‹ (å‹•æ¼«é¢¨) -->
                            <path
                                d="M 68 95 Q 80 75 100 80 Q 120 75 132 95 Q 128 85 115 88 Q 100 70 85 88 Q 72 85 68 95"
                                fill="#8B4513" stroke="#000000" stroke-width="2" id="hair" />
                            <!-- å‹•æ„Ÿç€æµ· -->
                            <path d="M 72 110 Q 85 95 100 105 Q 115 95 128 110" fill="#8B4513" stroke="#000000"
                                stroke-width="2" id="bangs" />
                            <!-- å´é‚Šé ­é«®æŸ -->
                            <ellipse cx="70" cy="120" rx="8" ry="20" fill="#8B4513" stroke="#000000" stroke-width="2"
                                id="hairLeft" />
                            <ellipse cx="130" cy="120" rx="8" ry="20" fill="#8B4513" stroke="#000000" stroke-width="2"
                                id="hairRight" />
                            <!-- é ­é«®é«˜å…‰ (æ¥“ä¹‹è°·é¢¨æ ¼) -->
                            <ellipse cx="92" cy="88" rx="4" ry="10" fill="#D2691E" id="hairHighlight" />
                            <ellipse cx="108" cy="88" rx="4" ry="10" fill="#D2691E" id="hairHighlight2" />

                            <!-- æ¥“ä¹‹è°·ç‰¹è‰²å¤§çœ¼ç› -->
                            <ellipse cx="88" cy="115" rx="10" ry="12" fill="white" stroke="#000000" stroke-width="2"
                                id="leftEye" />
                            <ellipse cx="112" cy="115" rx="10" ry="12" fill="white" stroke="#000000" stroke-width="2"
                                id="rightEye" />
                            <!-- ç³å­” (å‹•æ¼«é¢¨) -->
                            <circle cx="88" cy="117" r="5" fill="#4169E1" id="leftPupil" />
                            <circle cx="112" cy="117" r="5" fill="#4169E1" id="rightPupil" />
                            <!-- çœ¼ç›é«˜å…‰ (æ¥“ä¹‹è°·ç‰¹è‰²) -->
                            <circle cx="90" cy="114" r="2" fill="white" id="leftHighlight" />
                            <circle cx="114" cy="114" r="2" fill="white" id="rightHighlight" />
                            <ellipse cx="86" cy="119" rx="1" ry="2" fill="white" id="leftHighlight2" />
                            <ellipse cx="110" cy="119" rx="1" ry="2" fill="white" id="rightHighlight2" />

                            <!-- ç²—çœ‰æ¯› (æ¥“ä¹‹è°·é¢¨æ ¼) -->
                            <rect x="78" y="105" width="15" height="4" rx="2" fill="#654321" id="leftEyebrow" />
                            <rect x="107" y="105" width="15" height="4" rx="2" fill="#654321" id="rightEyebrow" />

                            <!-- å°é¼»å­ (ç°¡åŒ–) -->
                            <circle cx="100" cy="128" r="2" fill="#E6B8A2" stroke="#000000" stroke-width="1"
                                id="nose" />

                            <!-- å˜´å·´ (æ¥“ä¹‹è°·é¢¨æ ¼) -->
                            <path d="M 92 138 Q 100 143 108 138" stroke="#000000" stroke-width="2.5" fill="none"
                                id="mouth" />

                            <!-- è‡‰é °ç´…æšˆ (æ¥“ä¹‹è°·ç‰¹è‰²) -->
                            <circle cx="68" cy="128" r="5" fill="#ff69b4" opacity="0.6" id="leftCheek" />
                            <circle cx="132" cy="128" r="5" fill="#ff69b4" opacity="0.6" id="rightCheek" />

                            <!-- é“å…·å€åŸŸ -->
                            <g id="actionItem">
                                <!-- æ›¸åŒ… (æ¥“ä¹‹è°·é¢¨æ ¼) -->
                                <rect x="50" y="165" width="15" height="18" rx="3" fill="#4f46e5" stroke="#000000"
                                    stroke-width="2" />
                                <rect x="52" y="167" width="11" height="14" rx="2" fill="#6366f1" />
                                <circle cx="57" cy="170" r="2" fill="#fbbf24" stroke="#000000" stroke-width="1" />
                                <!-- æ›¸åŒ…å¸¶ -->
                                <path d="M 57 158 Q 65 162 68 168" stroke="#374151" stroke-width="3" fill="none" />
                            </g>

                            <!-- æ±—ç  (éš±è—) -->
                            <g id="sweatDrops" style="opacity: 0;">
                                <ellipse cx="72" cy="85" rx="4" ry="6" fill="#87ceeb" stroke="#000000"
                                    stroke-width="1" />
                                <ellipse cx="128" cy="85" rx="4" ry="6" fill="#87ceeb" stroke="#000000"
                                    stroke-width="1" />
                                <circle cx="72" cy="91" r="2" fill="#b0e0e6" />
                                <circle cx="128" cy="91" r="2" fill="#b0e0e6" />
                            </g>

                            <!-- éŒ¢åŒ… (éš±è—) -->
                            <g id="wallet" style="opacity: 0;">
                                <rect x="130" y="168" width="12" height="8" rx="2" fill="#8B4513" stroke="#000000"
                                    stroke-width="1.5" />
                                <rect x="131" y="169" width="10" height="6" rx="1" fill="#fbbf24" />
                                <circle cx="136" cy="172" r="1" fill="#cd7f32" />
                            </g>
                        </svg>
                    </div>
                </div>

                <!-- å³å´ï¼šèŠ±è²»çµ±è¨ˆï¼Œåˆ†åˆ—æœ‰é¤é£²ã€äº¤é€šã€å¨›æ¨‚ã€æ—¥ç”¨å“åŠç¸½è¨ˆ -->
                <div class="h-full flex flex-col space-y-3">
                    <!-- èŠ±è²»çµ±è¨ˆæ¨™é¡Œ -->
                    <div class="bg-green-50 rounded-xl p-3">
                        <h3 class="text-sm font-bold text-green-800 text-center mb-3">èŠ±è²»çµ±è¨ˆ</h3>

                        <!-- å„é¡åˆ¥èŠ±è²» -->
                        <div class="space-y-2 h-full flex flex-col justify-center">
                            <div class="flex items-center justify-between bg-white rounded-lg p-2">
                                <span class="text-lg">ğŸ½ï¸</span>
                                <span class="font-bold text-orange-600" id="foodTotal">0å…ƒ</span>
                            </div>

                            <div class="flex items-center justify-between bg-white rounded-lg p-2">
                                <span class="text-lg">ğŸšŒ</span>
                                <span class="font-bold text-blue-600" id="transportTotal">0å…ƒ</span>
                            </div>

                            <div class="flex items-center justify-between bg-white rounded-lg p-2">
                                <span class="text-lg">ğŸ®</span>
                                <span class="font-bold text-purple-600" id="entertainmentTotal">0å…ƒ</span>
                            </div>

                            <div class="flex items-center justify-between bg-white rounded-lg p-2">
                                <span class="text-lg">ğŸ§´</span>
                                <span class="font-bold text-green-600" id="dailyTotal">0å…ƒ</span>
                            </div>
                        </div>
                    </div>

                    <!-- ç¸½è¨ˆ -->
                    <div class="bg-red-100 rounded-xl p-3 flex-shrink-0">
                        <div class="flex items-center justify-between">
                            <span class="text-sm font-bold text-red-800">ç¸½è¨ˆ</span>
                            <span class="text-sm font-bold text-red-600" id="totalAmountRight">0å…ƒ</span>
                        </div>
                        <div class="mt-2 text-xs text-red-600 text-center">
                            ä½”é ç®—æ¯”ä¾‹ï¼š<span id="budgetPercentage" class="font-medium">0%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2.5 mt-2">
                            <div id="progressBar" class="bg-green-500 h-2.5 rounded-full progress-bar"
                                style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ç¬¬äºŒåˆ—ï¼šèªéŒ„ -->
        <div class="bg-white rounded-3xl shadow-lg p-6 mb-8">
            <div class="bg-gradient-to-r from-pink-100 to-purple-100 rounded-2xl p-6 text-center">
                <p class="text-sm font-medium text-purple-800" id="quote">
                    æ‰“å·¥è³ºéŒ¢ä¸å®¹æ˜“ï¼Œæ¯ä¸€åˆ†éŒ¢éƒ½è¦ç²¾æ‰“ç´°ç®—ã€‚
                </p>
            </div>
        </div>

        <!-- èŠ±è²»è¼¸å…¥å€ -->
        <div class="bg-white rounded-3xl shadow-lg p-6 mt-8">
            <h3 class="text-sm font-bold text-purple-800 mb-4 text-center">ğŸ’³ è¨˜éŒ„èŠ±è²»</h3>
            <div class="grid md:grid-cols-4 gap-4 mb-4">
                <select id="category"
                    class="px-4 py-3 border-2 border-purple-200 rounded-2xl focus:border-purple-400 focus:outline-none">
                    <option value="">é¸æ“‡é¡åˆ¥</option>
                    <option value="food">ğŸ½ï¸ é¤é£²</option>
                    <option value="transport">ğŸšŒ äº¤é€š</option>
                    <option value="entertainment">ğŸ® å¨›æ¨‚</option>
                    <option value="daily">ğŸ§´ æ—¥ç”¨å“</option>
                </select>
                <input type="text" id="description" placeholder="èŠ±è²»ç´°ç¯€ (å¦‚ï¼šæ—©é¤ã€æ·é‹ç¥¨)"
                    class="px-4 py-3 border-2 border-purple-200 rounded-2xl focus:border-purple-400 focus:outline-none">
                <input type="number" id="amount" placeholder="é‡‘é¡"
                    class="px-4 py-3 border-2 border-purple-200 rounded-2xl focus:border-purple-400 focus:outline-none">
                <button onclick="addExpense()"
                    class="bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white px-6 py-3 rounded-2xl font-medium transition-all">
                    æ–°å¢ âœ¨
                </button>
            </div>
        </div>

        <!-- èŠ±è²»è¨˜éŒ„ -->
        <div class="bg-white rounded-3xl shadow-lg p-6 mt-8">
            <h3 class="text-sm font-bold text-purple-800 mb-4">ğŸ“ ä»Šæ—¥èŠ±è²»è¨˜éŒ„</h3>
            <div id="expenseList" class="space-y-2">
                <p class="text-gray-500 text-center py-8">é‚„æ²’æœ‰ä»»ä½•èŠ±è²»è¨˜éŒ„å–”ï½</p>
            </div>
        </div>
    </div>

    <script>
        let totalSpent = 0;
        let dailyBudgetAmount = 0;
        let expenses = [];
        let categoryTotals = {
            food: 0,
            transport: 0,
            entertainment: 0,
            daily: 0
        };

        const quotes = [
            "æ‰“å·¥è³ºéŒ¢ä¸å®¹æ˜“ï¼Œæ¯ä¸€åˆ†éŒ¢éƒ½è¦ç²¾æ‰“ç´°ç®—ã€‚",
            "å¶çˆ¾èŠ±é»éŒ¢çŠ’è³è‡ªå·±ï¼Œé€™æ˜¯æ‡‰è©²çš„ã€‚",
            "å—¯...èŠ±è²»æœ‰é»è¶…å‡ºé æœŸï¼Œéœ€è¦æ§åˆ¶ä¸€ä¸‹ã€‚",
            "é€™å€‹æ¶ˆè²»é€Ÿåº¦æœ‰é»å¿«ï¼Œå¾—é‡æ–°æª¢è¦–é ç®—ã€‚",
            "æƒ…æ³é–‹å§‹ä¸å¦™ï¼Œé€™å€‹æœˆå¯èƒ½æœƒå¾ˆç·Šã€‚",
            "å¿…é ˆå†·éœä¸‹ä¾†ï¼Œä¸èƒ½å†é€™æ¨£äº‚èŠ±éŒ¢äº†ã€‚",
            "ç³Ÿç³•ï¼Œç…§é€™æ¨£ä¸‹å»æœƒå…¥ä¸æ•·å‡ºã€‚",
            "å®Œäº†ï¼Œç”Ÿæ´»è²»éƒ½å¿«ä¸å¤ äº†ã€‚",
            "é€™ä¸‹çœŸçš„éº»ç…©äº†ï¼ŒéŒ¢åŒ…å¿«è¦‹åº•äº†ã€‚",
            "å¾¹åº•ç ´ç”¢ï¼Œé€£åŸºæœ¬ç”Ÿæ´»éƒ½æˆå•é¡Œäº†ã€‚"
        ];

        const characterStates = [
            // ç¬¬1æ ¼ï¼šé–‹å¿ƒè¡¨æƒ… (æ¥“ä¹‹è°·é¢¨æ ¼)
            {
                mouth: "M 92 138 Q 100 143 108 138",
                leftPupil: { cx: 88, cy: 117 },
                rightPupil: { cx: 112, cy: 117 },
                leftCheek: { opacity: 0.6 },
                rightCheek: { opacity: 0.6 },
                sweatDrops: { opacity: 0 },
                wallet: { opacity: 0 },
                actionItem: `
<rect x="50" y="165" width="15" height="18" rx="3" fill="#4f46e5" stroke="#000000" stroke-width="2"/>
<rect x="52" y="167" width="11" height="14" rx="2" fill="#6366f1"/>
<circle cx="57" cy="170" r="2" fill="#fbbf24" stroke="#000000" stroke-width="1"/>
<path d="M 57 158 Q 65 162 68 168" stroke="#374151" stroke-width="3" fill="none"/>
`
            },
            // ç¬¬2æ ¼ï¼šæ»¿æ„ (æ¥“ä¹‹è°·é¢¨æ ¼)
            {
                mouth: "M 90 137 Q 100 142 110 137",
                leftPupil: { cx: 88, cy: 117 },
                rightPupil: { cx: 112, cy: 117 },
                leftCheek: { opacity: 0.6 },
                rightCheek: { opacity: 0.6 },
                sweatDrops: { opacity: 0 },
                wallet: { opacity: 0 },
                actionItem: `
<rect x="50" y="165" width="15" height="18" rx="3" fill="#4f46e5" stroke="#000000" stroke-width="2"/>
<rect x="52" y="167" width="11" height="14" rx="2" fill="#6366f1"/>
<circle cx="57" cy="170" r="2" fill="#fbbf24" stroke="#000000" stroke-width="1"/>
<path d="M 57 158 Q 65 162 68 168" stroke="#374151" stroke-width="3" fill="none"/>
`
            },
            // ç¬¬3æ ¼ï¼šç¨å¾®æ“”å¿ƒ
            {
                mouth: "M 94 139 Q 100 140 106 139",
                leftPupil: { cx: 86, cy: 118 },
                rightPupil: { cx: 114, cy: 118 },
                leftCheek: { opacity: 0.4 },
                rightCheek: { opacity: 0.4 },
                sweatDrops: { opacity: 0 },
                wallet: { opacity: 0 },
                actionItem: ``
            },
            // ç¬¬4æ ¼ï¼šé–‹å§‹æ“”å¿ƒ
            {
                mouth: "M 96 140 L 104 140",
                leftPupil: { cx: 86, cy: 119 },
                rightPupil: { cx: 114, cy: 119 },
                leftCheek: { opacity: 0.3 },
                rightCheek: { opacity: 0.3 },
                sweatDrops: { opacity: 0.5 },
                wallet: { opacity: 0 },
                actionItem: ``
            },
            // ç¬¬5æ ¼ï¼šæª¢æŸ¥éŒ¢åŒ…
            {
                mouth: "M 97 141 L 103 141",
                leftPupil: { cx: 86, cy: 119 },
                rightPupil: { cx: 114, cy: 119 },
                leftCheek: { opacity: 0.2 },
                rightCheek: { opacity: 0.2 },
                sweatDrops: { opacity: 0.7 },
                wallet: { opacity: 1 },
                actionItem: ``
            },
            // ç¬¬6æ ¼ï¼šç·Šå¼µ
            {
                mouth: "M 98 142 L 102 142",
                leftPupil: { cx: 85, cy: 119 },
                rightPupil: { cx: 115, cy: 119 },
                leftCheek: { opacity: 0.1 },
                rightCheek: { opacity: 0.1 },
                sweatDrops: { opacity: 1 },
                wallet: { opacity: 1 },
                actionItem: ``
            },
            // ç¬¬7æ ¼ï¼šåš´é‡è­¦å‘Š (æ¥“ä¹‹è°·é¢¨æ ¼)
            {
                mouth: "M 90 145 Q 100 151 110 145",
                leftPupil: { cx: 85, cy: 119 },
                rightPupil: { cx: 115, cy: 119 },
                leftCheek: { opacity: 0 },
                rightCheek: { opacity: 0 },
                sweatDrops: { opacity: 1 },
                wallet: { opacity: 1 },
                actionItem: `
<circle cx="100" cy="240" r="12" fill="#FF0000" stroke="#000000" stroke-width="2" opacity="0.8">
<animate attributeName="opacity" values="0.8;0.3;0.8" dur="1s" repeatCount="indefinite"/>
</circle>
<text x="100" y="246" text-anchor="middle" font-size="12" fill="white" font-weight="bold" stroke="#000000" stroke-width="0.5">!</text>
`
            },
            // ç¬¬8æ ¼ï¼šç—›è‹¦è¡¨æƒ… (æ¥“ä¹‹è°·é¢¨æ ¼)
            {
                mouth: "M 88 148 Q 100 155 112 148",
                leftPupil: { cx: 85, cy: 120 },
                rightPupil: { cx: 115, cy: 120 },
                leftCheek: { opacity: 0 },
                rightCheek: { opacity: 0 },
                sweatDrops: { opacity: 1 },
                wallet: { opacity: 1 },
                actionItem: ``
            },
            // ç¬¬9æ ¼ï¼šçµ•æœ› (æ¥“ä¹‹è°·é¢¨æ ¼)
            {
                mouth: "M 85 151 Q 100 161 115 151",
                leftPupil: { cx: 84, cy: 120 },
                rightPupil: { cx: 116, cy: 120 },
                leftCheek: { opacity: 0 },
                rightCheek: { opacity: 0 },
                sweatDrops: { opacity: 1 },
                wallet: { opacity: 1 },
                actionItem: `
<g>
<path d="M 45 80 L 52 75 L 59 80 L 52 85 Z" fill="#FFD700" stroke="#000000" stroke-width="1">
<animateTransform attributeName="transform" type="rotate" values="0 52 80;360 52 80" dur="2s" repeatCount="indefinite"/>
</path>
<path d="M 141 80 L 148 75 L 155 80 L 148 85 Z" fill="#FFD700" stroke="#000000" stroke-width="1">
<animateTransform attributeName="transform" type="rotate" values="0 148 80;-360 148 80" dur="2s" repeatCount="indefinite"/>
</path>
</g>
`
            },
            // ç¬¬10æ ¼ï¼šå®Œå…¨ç ´ç”¢ (æ¥“ä¹‹è°·é¢¨æ ¼)
            {
                mouth: "M 82 155 Q 100 168 118 155",
                leftPupil: { cx: 84, cy: 121 },
                rightPupil: { cx: 116, cy: 121 },
                leftCheek: { opacity: 0 },
                rightCheek: { opacity: 0 },
                sweatDrops: { opacity: 1 },
                wallet: { opacity: 1 },
                actionItem: `
<g>
<rect x="130" y="168" width="12" height="8" rx="2" fill="#8B4513" stroke="#000000" stroke-width="1.5"/>
<rect x="131" y="169" width="10" height="6" rx="1" fill="#fbbf24"/>
<circle cx="136" cy="172" r="1" fill="#cd7f32"/>
<ellipse cx="136" cy="155" rx="4" ry="3" fill="#666" opacity="0.7">
<animate attributeName="cy" values="155;145;155" dur="2s" repeatCount="indefinite"/>
</ellipse>
<text x="136" y="188" text-anchor="middle" font-size="10" fill="#FF0000" font-weight="bold" stroke="#000000" stroke-width="0.5">ç ´ç”¢</text>
</g>
`
            }
        ];

        function setUserInfo() {
            const name = document.getElementById('userNameInput').value;
            const budget = parseInt(document.getElementById('dailyBudgetInput').value) || 0;

            if (name && budget > 0) {
                // 1. æ›´æ–°é¡¯ç¤ºè³‡è¨Š
                document.getElementById('displayName').textContent = name;
                document.getElementById('displayBudget').textContent = budget;
                document.getElementById('characterName').textContent = name;
                document.getElementById('characterBudget').textContent = budget;

                // 2. è¨­å®šé ç®—é‡‘é¡åˆ°å…¨åŸŸè®Šæ•¸
                dailyBudgetAmount = budget;

                // 3. æ›´æ–°é ç®—ç‹€æ…‹é¢æ¿
                updateBudgetStatus();

                // 4. é¡¯ç¤ºä½¿ç”¨è€…è³‡è¨Šå¡ç‰‡ä¸¦æ·»åŠ å‹•ç•«
                const userDisplay = document.getElementById('userDisplay');
                userDisplay.classList.remove('bounce-in'); // å…ˆç§»é™¤å‹•ç•«ï¼Œç¢ºä¿æ¯æ¬¡é»æ“Šéƒ½è§¸ç™¼
                void userDisplay.offsetWidth; // è§¸ç™¼é‡ç¹ª
                userDisplay.style.opacity = '1';
                userDisplay.classList.add('bounce-in');

                // 5. æ¸…ç©ºè¼¸å…¥æ¡†
                document.getElementById('userNameInput').value = '';
                document.getElementById('dailyBudgetInput').value = '';
            } else {
                alert('è«‹ç¢ºä¿å·²è¼¸å…¥å§“åï¼Œä¸”é ç®—é‡‘é¡å¤§æ–¼ 0 ï¼');
            }
        }

        function addExpense() {
            const category = document.getElementById('category').value;
            const description = document.getElementById('description').value;
            const amount = parseInt(document.getElementById('amount').value) || 0;

            if (!category || !description || amount <= 0) {
                alert('è«‹å¡«å¯«å®Œæ•´çš„èŠ±è²»è³‡è¨Šï¼');
                return;
            }

            // æ·»åŠ åˆ°è¨˜éŒ„
            expenses.push({ category, description, amount, time: new Date() });
            totalSpent += amount;
            categoryTotals[category] += amount;

            // æ›´æ–°é¡¯ç¤º
            updateDisplay();
            updateBudgetStatus();
            updateCategoryTotals();
            addExpenseToList(category, description, amount);

            // æ¸…ç©ºè¼¸å…¥æ¡†
            document.getElementById('category').value = '';
            document.getElementById('description').value = '';
            document.getElementById('amount').value = '';
        }

        function updateDisplay() {
            const percentage = dailyBudgetAmount > 0 ? (totalSpent / dailyBudgetAmount) * 100 : 0;
            const level = Math.min(Math.floor(percentage / 10), 9);

            // æ›´æ–°ç¸½é‡‘é¡
            document.getElementById('totalAmountRight').textContent = totalSpent + 'å…ƒ';
            updateBudgetPercentage();

            // æ›´æ–°é€²åº¦æ¢
            const progressBar = document.getElementById('progressBar');
            progressBar.style.width = Math.min(percentage, 100) + '%';

            // æ ¹æ“šèŠ±è²»æ¯”ä¾‹æ›´æ–°é€²åº¦æ¢é¡è‰²
            progressBar.classList.remove('pulse-red', 'bg-green-500', 'bg-yellow-500', 'bg-red-500'); // å…ˆç§»é™¤æ‰€æœ‰é¡è‰²
            if (percentage < 50) {
                progressBar.classList.add('bg-green-500');
            } else if (percentage < 90) {
                progressBar.classList.add('bg-yellow-500');
            } else {
                progressBar.classList.add('bg-red-500');
            }

            // æ›´æ–°è§’è‰²å’ŒèªéŒ„
            document.getElementById('quote').textContent = quotes[level];
            updateCharacterAppearance(level);

            // æ·»åŠ ç‰¹æ•ˆ
            if (level >= 7) {
                document.querySelector('.character-animation').classList.add('shake');
                setTimeout(() => {
                    document.querySelector('.character-animation').classList.remove('shake');
                }, 500);
            }

            // è¶…éé ç®—æ™‚ï¼Œæ·»åŠ ç´…è‰²é–ƒçˆå‹•ç•«
            if (percentage >= 100) {
                progressBar.classList.add('pulse-red');
            }
        }

        function updateBudgetPercentage() {
            const percentage = dailyBudgetAmount > 0 ? (totalSpent / dailyBudgetAmount) * 100 : 0;
            document.getElementById('budgetPercentage').textContent = Math.round(percentage) + '%';
        }

        function updateBudgetStatus() {
            const remaining = Math.max(0, dailyBudgetAmount - totalSpent);
            const remainingEl = document.getElementById('remainingAmount');

            document.getElementById('budgetLimit').textContent = dailyBudgetAmount;
            document.getElementById('spentAmount').textContent = totalSpent;
            remainingEl.textContent = remaining;

            // Change color to red if budget is used up, otherwise keep it green
            if (remaining === 0 && dailyBudgetAmount > 0) {
                remainingEl.parentElement.classList.remove('text-green-600');
                remainingEl.parentElement.classList.add('text-red-600');
            } else {
                remainingEl.parentElement.classList.remove('text-red-600');
                remainingEl.parentElement.classList.add('text-green-600');
            }
        }

        function updateCharacterAppearance(level) {
            const state = characterStates[level];

            // æ›´æ–°å˜´å·´
            document.getElementById('mouth').setAttribute('d', state.mouth);

            // æ›´æ–°ç³å­”ä½ç½®
            document.getElementById('leftPupil').setAttribute('cx', state.leftPupil.cx);
            document.getElementById('leftPupil').setAttribute('cy', state.leftPupil.cy);
            document.getElementById('rightPupil').setAttribute('cx', state.rightPupil.cx);
            document.getElementById('rightPupil').setAttribute('cy', state.rightPupil.cy);

            // æ›´æ–°è‡‰é °ç´…æšˆ
            document.getElementById('leftCheek').style.opacity = state.leftCheek.opacity;
            document.getElementById('rightCheek').style.opacity = state.rightCheek.opacity;

            // æ›´æ–°æ±—ç 
            document.getElementById('sweatDrops').style.opacity = state.sweatDrops.opacity;

            // æ›´æ–°éŒ¢åŒ…
            document.getElementById('wallet').style.opacity = state.wallet.opacity;

            // æ›´æ–°é“å…·
            document.getElementById('actionItem').innerHTML = state.actionItem;
        }

        function updateCategoryTotals() {
            document.getElementById('foodTotal').textContent = categoryTotals.food + 'å…ƒ';
            document.getElementById('transportTotal').textContent = categoryTotals.transport + 'å…ƒ';
            document.getElementById('entertainmentTotal').textContent = categoryTotals.entertainment + 'å…ƒ';
            document.getElementById('dailyTotal').textContent = categoryTotals.daily + 'å…ƒ';
        }

        function addExpenseToList(category, description, amount) {
            const expenseList = document.getElementById('expenseList');

            // å¦‚æœæ˜¯ç¬¬ä¸€ç­†è¨˜éŒ„ï¼Œæ¸…ç©ºæç¤ºæ–‡å­—
            if (expenses.length === 1) {
                expenseList.innerHTML = '';
            }

            const categoryIcons = {
                food: 'ğŸ½ï¸',
                transport: 'ğŸšŒ',
                entertainment: 'ğŸ®',
                daily: 'ğŸ§´'
            };

            const categoryNames = {
                food: 'é¤é£²',
                transport: 'äº¤é€š',
                entertainment: 'å¨›æ¨‚',
                daily: 'æ—¥ç”¨å“'
            };

            const expenseItem = document.createElement('div');
            expenseItem.className = 'flex justify-between items-center bg-gray-50 rounded-xl p-4 bounce-in';
            expenseItem.innerHTML = `
<div class="flex items-center gap-3">
<span class="text-lg">${categoryIcons[category]}</span>
<div>
<div class="font-medium text-purple-800 text-sm">${description}</div>
<div class="text-xs text-purple-600">${categoryNames[category]}</div>
</div>
</div>
<div class="text-sm font-bold text-red-500">-${amount}å…ƒ</div>
`;

            expenseList.insertBefore(expenseItem, expenseList.firstChild);
        }

        // æŒ‰ Enter éµä¹Ÿèƒ½æ–°å¢èŠ±è²»
        document.getElementById('amount').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                addExpense();
            }
        });
    </script>
    <script>(function () { function c() { var b = a.contentDocument || a.contentWindow.document; if (b) { var d = b.createElement('script'); d.innerHTML = "window.__CF$cv$params={r:'9815a12bd402828b',t:'MTc1ODI0ODY5Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);"; b.getElementsByTagName('head')[0].appendChild(d) } } if (document.body) { var a = document.createElement('iframe'); a.height = 1; a.width = 1; a.style.position = 'absolute'; a.style.top = 0; a.style.left = 0; a.style.border = 'none'; a.style.visibility = 'hidden'; document.body.appendChild(a); if ('loading' !== document.readyState) c(); else if (window.addEventListener) document.addEventListener('DOMContentLoaded', c); else { var e = document.onreadystatechange || function () { }; document.onreadystatechange = function (b) { e(b); 'loading' !== document.readyState && (document.onreadystatechange = e, c()) } } } })();</script>
</body>

</html>